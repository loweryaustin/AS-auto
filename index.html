<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Call Script Tool</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- NEW: Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
<!-- CSS_INJECTION_POINT -->

</head>
<body class="bg-gray-900 text-gray-200">
    
    <!-- Settings Cog -->
    <button id="settings-cog-btn" class="fixed top-6 left-6 z-50 text-gray-400 hover:text-white transition-colors">
        <i data-lucide="settings" class="w-8 h-8"></i>
    </button>

    <!-- Settings Modal -->
    <div id="settings-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-80 z-50 p-4 overflow-y-auto">
        <div class="bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8 w-full max-w-3xl mx-auto my-8 flex flex-col relative">
            <div class="flex justify-between items-center mb-4 flex-shrink-0">
                <h2 class="text-2xl font-bold text-white">Settings</h2>
                <!-- This span is the injection target for the build script -->
                <span id="app-version" class="text-xs text-gray-500 font-mono"></span>
                <button id="settings-close-btn" class="text-gray-400 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <!-- LocalStorage Warning -->
            <div id="settings-warning-box" class="settings-warning-box hidden p-4 rounded-lg mb-4">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <svg class="h-5 w-5 warning-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                            <path fill-rule="evenodd" d="M8.257 3.099c.636-1.076 2.384-1.076 3.02 0l6.25 10.5c.636 1.076-.24 2.401-1.51 2.401H3.517c-1.27 0-2.146-1.325-1.51-2.401l6.25-10.5zM10 16a1 1 0 100-2 1 1 0 000 2zM9 13V8h2v5H9z" clip-rule="evenodd" />
                        </svg>
                    </div>
                    <div class="ml-3">
                        <h3 class="text-sm font-medium warning-title">Warning: Backup Your Settings</h3>
                        <div class="mt-2 text-sm warning-text">
                            <p>Your settings are stored in this browser's local storage, which can be unstable and easily cleared. Please use the **Export** buttons below to download a backup file of your settings and custom databases.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Content -->
            <div id="settings-modal-content" class="space-y-6">
                
                <!-- Section 1: Application Settings -->
                <section class="settings-section">
                    <h3 class="settings-section-title">1. Application Settings</h3>
                    <!-- Agent Details -->
                    <div class="settings-subsection">
                        <label for="agent-name-setting" class="block text-sm font-medium text-gray-300 mb-1">Agent Name</label>
                        <input type="text" id="agent-name-setting" class="w-full bg-gray-700 border-gray-600 text-white rounded-lg p-3 focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Timer Segments -->
                    <div class="settings-subsection">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-lg font-semibold text-gray-300">Timer Segments</h4>
                            <button id="add-segment-btn" class="bg-green-600 hover:bg-green-700 text-white text-sm font-bold py-2 px-4 rounded-lg transition-colors">
                                Add Segment
                            </button>
                        </div>
                        <div id="segment-settings-list" class="space-y-3">
                            <!-- Segments will be dynamically inserted here -->
                        </div>
                    </div>
                    
                    <!-- App I/O Controls -->
                    <div class="settings-io-controls">
                        <h4 class="text-sm font-semibold text-gray-400 mb-2">Manage App Settings</h4>
                        <div class="flex flex-wrap gap-3">
                            <button id="export-app-settings-btn" class="settings-io-btn bg-gray-600 hover:bg-gray-500">Download App Settings</button>
                            <button id="import-app-settings-btn" class="settings-io-btn bg-gray-600 hover:bg-gray-500">Import App Settings</button>
                        </div>
                    </div>
                </section>
                
                <!-- Section 2: Database Settings -->
                <section class="settings-section">
                    <h3 class="settings-section-title">2. Database Settings</h3>
                    
                    <!-- Supplement Wording -->
                    <div class="settings-subsection">
                        <h4 class="text-lg font-semibold text-yellow-400 mb-3">Edit Current Supplement: <span id="current-db-name-display" class="font-bold">...</span></h4>
                        
                        <!-- NEW (V7.3.7): Product Line Editor -->
                        <div class="p-4 bg-gray-900 rounded-lg mb-4">
                            <label class="block text-sm font-semibold text-blue-300 mb-1">Product Line</label>
                            <div class="relative">
                                <input type="text" id="product-line-setting" class="w-full bg-gray-700 border-gray-600 text-white rounded-lg p-3 focus:ring-2 focus:ring-blue-500" placeholder="e.g., General Health" autocomplete="off">
                                <div id="product-line-setting-results" class="hidden absolute top-full left-0 w-full bg-gray-700 border border-gray-600 rounded-b-lg shadow-xl z-20 max-h-40 overflow-y-auto"></div>
                            </div>
                            <p class="text-xs text-gray-500 mt-1 italic">Type to search existing lines or create a new one.</p>
                        </div>

                        <!-- Discovery Questions Editor -->
                        <div class="p-4 bg-gray-900 rounded-lg mb-4">
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="text-md font-semibold text-blue-300">Discovery Questions</h4>
                                <span class="text-xs text-gray-400 italic">Use the "Quick Edit" cog on the main page to edit questions with groups.</span>
                            </div>
                            <div id="questions-editor-list" class="space-y-2">
                                <!-- Legacy flat editor placeholder -->
                            </div>
                        </div>

                        <!-- Base Product -->
                        <div class="p-4 bg-gray-900 rounded-lg mb-4">
                            <h4 class="text-md font-semibold text-blue-300 mb-2">Base Product</h4>
                            <div class="space-y-3">
                                 <div>
                                    <label class="text-xs text-gray-400">Name</label>
                                    <input type="text" id="base-product-name-setting" class="w-full bg-gray-700 text-white rounded p-2 text-sm">
                                </div>
                                <div>
                                    <label class="text-xs text-gray-400">Pitch (in sidebar)</label>
                                    <textarea id="base-product-pitch-setting" rows="2" class="w-full bg-gray-700 text-white rounded p-2 text-sm"></textarea>
                                </div>
                                <div>
                                    <label class="text-xs text-gray-400">Guarantee Length (Days)</label>
                                    <input type="number" id="base-product-guarantee-setting" class="w-full bg-gray-700 text-white rounded p-2 text-sm">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Recommendations -->
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="text-md font-semibold text-green-300">Recommendations</h4>
                            <div class="flex gap-2">
                                <button id="import-from-library-btn" class="bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold py-1 px-3 rounded-lg transition-colors flex items-center gap-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" /></svg>
                                    Import from Library
                                </button>
                                <button id="add-supplement-btn" class="bg-green-600 hover:bg-green-700 text-white text-xs font-bold py-1 px-3 rounded-lg transition-colors">
                                    + Add New
                                </button>
                            </div>
                        </div>
                        <div id="supplement-settings-list" class="space-y-3">
                            <!-- Supplement recommendations will be dynamically inserted here -->
                        </div>

                        <!-- References (Moved inside Database Settings) -->
                        <div class="border-t border-gray-700 pt-4 mt-6">
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="text-md font-semibold text-gray-300">Reference Links & Shortcuts</h4>
                                <button id="add-reference-btn" class="bg-green-600 hover:bg-green-700 text-white text-xs font-bold py-1 px-3 rounded-lg transition-colors">
                                    Add Reference
                                </button>
                            </div>
                            <div id="reference-settings-list" class="space-y-3">
                                <!-- References will be dynamically inserted here -->
                            </div>
                        </div>
                    </div>

                    <!-- Database I/O Controls -->
                    <div class="settings-io-controls">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="text-sm font-semibold text-gray-400">Current Database</h4>
                            <span class="text-xs text-gray-500 italic">Actions for <span id="io-current-db-name">...</span></span>
                        </div>
                         <div class="flex flex-wrap gap-3">
                            <button id="export-db-btn" class="settings-io-btn bg-blue-600 hover:bg-blue-500">Download .JSON</button>
                            <button id="overwrite-db-btn" class="settings-io-btn bg-red-800 hover:bg-red-700 border border-red-600">Overwrite from File</button>
                            <input type="file" id="file-input-overwrite" class="hidden" accept=".json">
                        </div>
                    </div>

                    <!-- New Database I/O -->
                    <div class="settings-io-controls mt-4">
                        <h4 class="text-sm font-semibold text-gray-400 mb-2">Create New Database</h4>
                         <div class="flex flex-wrap gap-3">
                            <!-- Create Blank Button -->
                            <button id="create-blank-db-btn" class="settings-io-btn bg-yellow-600 hover:bg-yellow-700 border border-yellow-600">
                                + Create Blank Database
                            </button>
                            <!-- Upload New Button -->
                            <button id="upload-new-db-btn" class="settings-io-btn bg-green-600 hover:bg-green-700">
                                Upload New Database
                            </button>
                            <input type="file" id="file-input-new" class="hidden" accept=".json">
                        </div>
                    </div>
                </section>

                <!-- Section 3 Removed (Content moved to Section 2) -->

            </div>

            <!-- Settings Footer -->
            <div class="border-t border-gray-700 pt-6 flex flex-wrap justify-between items-center gap-4 flex-shrink-0 mt-6">
                <div>
                    <button id="reset-to-defaults-btn" class="bg-red-800 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg transition-colors text-lg">
                        Reset All
                    </button>
                </div>
                <div class="flex flex-wrap gap-4">
                    <span class="text-sm text-gray-400 italic">All changes are saved automatically.</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Library Import Modal (Simplified V7.6.0) -->
    <div id="library-import-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-90 z-[60] p-4 overflow-y-auto">
        <div class="bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8 w-full max-w-4xl border border-gray-700 flex flex-col mx-auto my-8 relative">
            <div class="flex justify-between items-center mb-6 flex-shrink-0">
                <h2 class="text-2xl font-bold text-white">Import from Library</h2>
                <button id="library-import-close-btn" class="text-gray-400 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <div class="space-y-6 flex-1 min-h-[300px]">
                
                <!-- Info Header -->
                <div class="bg-gray-900 p-4 rounded-lg border border-gray-700">
                    <p class="text-sm text-gray-400 mb-1 uppercase tracking-wider font-semibold">Current Product Line</p>
                    <p id="lib-current-line-display" class="text-xl font-bold text-blue-400">...</p>
                    <p class="text-xs text-gray-500 mt-2">Showing all available supplements in this product line from all databases.</p>
                </div>

                <!-- Search Input -->
                <div class="relative">
                    <label class="block text-sm font-medium text-gray-300 mb-1">Search Supplement</label>
                    <div class="relative">
                        <input type="text" id="lib-supplement-input" class="w-full bg-gray-700 border-gray-600 text-white rounded-lg p-3 pl-10 focus:ring-2 focus:ring-blue-500" placeholder="Type name..." autocomplete="off">
                        <div class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                            </svg>
                        </div>
                    </div>
                    <!-- Results Dropdown (Always visible/scrollable in this context) -->
                    <div id="lib-supplement-results" class="hidden mt-2 w-full bg-gray-700 border border-gray-600 rounded-lg shadow-xl z-10 max-h-96 overflow-y-auto"></div>
                </div>
            </div>

            <div class="mt-8 flex justify-end gap-3 flex-shrink-0">
                <button id="library-import-cancel-btn" class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg transition-colors">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Quick Edit Modal -->
    <div id="quick-edit-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-80 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8 w-full max-w-3xl max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center mb-4 flex-shrink-0">
                <h2 id="quick-edit-title" class="text-2xl font-bold text-white">Edit Supplement</h2>
                <button id="quick-edit-close-btn" class="text-gray-400 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div id="quick-edit-content" class="space-y-6 overflow-y-auto pr-2 flex-1">
                <!-- Content injected by script-settings.js -->
            </div>
        </div>
    </div>

    <!-- Reset Confirmation Modal -->
    <div id="reset-confirm-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-80 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8 w-full max-w-md">
            <h2 class="text-2xl font-bold text-white mb-4">Reset for Next Call?</h2>
            <p class="text-gray-300 mb-6">This will clear the client's name, reset the regimen, and reset the call timer. Your saved settings (agent info, timer segments, etc.) will not be affected.</p>
            <div class="flex justify-end gap-4">
                <button id="reset-cancel-btn" class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-5 rounded-lg transition-colors">
                    Cancel
                </button>
                <button id="reset-confirm-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-5 rounded-lg transition-colors">
                    Reset Call
                </button>
            </div>
        </div>
    </div>
    
    <!-- Reset to Defaults Confirmation Modal -->
    <div id="reset-defaults-confirm-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-80 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8 w-full max-w-md">
            <h2 class="text-2xl font-bold text-white mb-4">Reset All Settings & Data?</h2>
            <p class="text-gray-300 mb-6">This will erase ALL your saved data (Agent Name, Segments, and ALL supplement edits) and restore the original defaults. This action cannot be undone.</p>
            <p class="text-yellow-400 font-semibold mb-6">Are you sure you want to proceed?</p>
            <div class="flex justify-end gap-4">
                <button id="reset-defaults-cancel-btn" class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-5 rounded-lg transition-colors">
                    Cancel
                </button>
                <button id="reset-defaults-confirm-btn" class="bg-red-800 hover:bg-red-700 text-white font-bold py-2 px-5 rounded-lg transition-colors">
                    Yes, Reset All
                </button>
            </div>
        </div>
    </div>

    <!-- Import Config Modal -->
    <div id="import-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-80 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8 w-full max-w-xl">
            <div class="flex justify-between items-center mb-4">
                <h2 id="import-modal-title" class="text-2xl font-bold text-white">Import Configuration</h2>
                <button id="import-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <p id="import-modal-description" class="text-gray-300 mb-4">Paste your exported JSON object below.</p>
            <textarea id="import-textarea" class="import-textarea" placeholder="{ ... }"></textarea>
            <div id="import-message" class="import-message mt-2"></div>
            <div class="flex justify-end gap-4 mt-6">
                <button id="import-cancel-btn" class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-5 rounded-lg transition-colors">
                    Cancel
                </button>
                <button id="import-confirm-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-5 rounded-lg transition-colors">
                    Import & Save
                </button>
            </div>
        </div>
    </div>

    <!-- Reference Modal -->
    <div id="reference-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-80 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col">
            <!-- Modal Header -->
            <div class="flex justify-between items-center p-4 md:p-6 border-b border-gray-700 flex-shrink-0">
                <h2 id="reference-modal-title" class="text-2xl font-bold text-white">Reference</h2>
                <button id="reference-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <!-- Modal Content (Scrollable) -->
            <div id="reference-modal-content" class="p-4 md:p-6 overflow-y-auto flex-1">
                <!-- Content (Image or iFrame) will be injected here -->
            </div>
        </div>
    </div>

    <!-- NEW (V7.4.0): BMI Calculator Modal -->
    <div id="bmi-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-80 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-md border border-blue-900/50">
            <!-- Header -->
            <div class="flex justify-between items-center p-6 border-b border-gray-700">
                <h2 class="text-2xl font-bold text-white flex items-center gap-2">
                    <i data-lucide="calculator" class="w-6 h-6 text-blue-400"></i>
                    BMI Calculator
                </h2>
                <button id="bmi-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <div class="p-6 space-y-6">
                <!-- Unit Toggle -->
                <div class="flex bg-gray-700 rounded-lg p-1">
                    <div id="bmi-unit-standard" class="unit-toggle-btn active" data-unit="standard">Standard (lb/ft)</div>
                    <div id="bmi-unit-metric" class="unit-toggle-btn" data-unit="metric">Metric (kg/cm)</div>
                </div>

                <!-- Inputs -->
                <div class="space-y-4">
                    <!-- Standard Inputs -->
                    <div id="bmi-inputs-standard" class="grid grid-cols-2 gap-4">
                        <div class="col-span-2">
                            <label class="block text-xs font-semibold text-gray-400 mb-1 uppercase">Weight (lbs)</label>
                            <input type="number" id="bmi-weight-lbs" class="w-full bg-gray-700 border-gray-600 text-white rounded-lg p-3 text-lg font-semibold focus:ring-2 focus:ring-blue-500" placeholder="e.g. 180">
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-400 mb-1 uppercase">Height (ft)</label>
                            <input type="number" id="bmi-height-ft" class="w-full bg-gray-700 border-gray-600 text-white rounded-lg p-3 text-lg font-semibold focus:ring-2 focus:ring-blue-500" placeholder="5">
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-400 mb-1 uppercase">Height (in)</label>
                            <input type="number" id="bmi-height-in" class="w-full bg-gray-700 border-gray-600 text-white rounded-lg p-3 text-lg font-semibold focus:ring-2 focus:ring-blue-500" placeholder="10">
                        </div>
                    </div>

                    <!-- Metric Inputs (Hidden by default) -->
                    <div id="bmi-inputs-metric" class="grid grid-cols-2 gap-4 hidden">
                        <div>
                            <label class="block text-xs font-semibold text-gray-400 mb-1 uppercase">Weight (kg)</label>
                            <input type="number" id="bmi-weight-kg" class="w-full bg-gray-700 border-gray-600 text-white rounded-lg p-3 text-lg font-semibold focus:ring-2 focus:ring-blue-500" placeholder="e.g. 80">
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-400 mb-1 uppercase">Height (cm)</label>
                            <input type="number" id="bmi-height-cm" class="w-full bg-gray-700 border-gray-600 text-white rounded-lg p-3 text-lg font-semibold focus:ring-2 focus:ring-blue-500" placeholder="e.g. 175">
                        </div>
                    </div>
                </div>

                <!-- Result Display -->
                <div class="bmi-result-display">
                    <div class="text-sm text-gray-400 uppercase tracking-wide font-semibold">Calculated BMI</div>
                    <div id="bmi-result-value" class="bmi-value-large">--.-</div>
                    <div id="bmi-result-category" class="bmi-category-badge bg-gray-800 text-gray-500">Enter Details</div>
                </div>

                <!-- NEW V7.5.0: Healthy Range & Goal Grid -->
                <div class="bmi-details-container">
                    <div class="bmi-detail-item">
                        <div class="bmi-detail-label">Healthy Range</div>
                        <div id="bmi-healthy-range" class="bmi-detail-value">-- - -- lbs</div>
                    </div>
                    <div class="bmi-detail-item">
                        <div class="bmi-detail-label">To Reach Goal</div>
                        <div id="bmi-weight-goal" class="bmi-detail-value">--</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW (V7.8.0): A1C Chart Modal (UPDATED V7.8.1 with eAG Table) -->
    <div id="a1c-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-80 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-lg border border-purple-900/50 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center p-6 border-b border-gray-700">
                <h2 class="text-2xl font-bold text-white flex items-center gap-2">
                    <i data-lucide="droplet" class="w-6 h-6 text-purple-400"></i>
                    A1C & Glucose
                </h2>
                <button id="a1c-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div class="p-6 space-y-6">
                <!-- A1C Levels -->
                <div class="space-y-4">
                    <!-- Normal -->
                    <div class="bg-gray-700/50 rounded-lg p-4 border-l-4 border-green-500">
                        <div class="flex justify-between items-center mb-1">
                            <span class="font-bold text-green-400 text-lg">Normal</span>
                            <span class="font-mono text-xl font-bold">Below 5.7%</span>
                        </div>
                        <p class="text-sm text-gray-400">Healthy blood sugar levels.</p>
                    </div>
                    <!-- Prediabetes -->
                    <div class="bg-gray-700/50 rounded-lg p-4 border-l-4 border-yellow-500">
                        <div class="flex justify-between items-center mb-1">
                            <span class="font-bold text-yellow-400 text-lg">Prediabetes</span>
                            <span class="font-mono text-xl font-bold">5.7% – 6.4%</span>
                        </div>
                        <p class="text-sm text-gray-400">Elevated risk. Action needed.</p>
                    </div>
                    <!-- Diabetes -->
                    <div class="bg-gray-700/50 rounded-lg p-4 border-l-4 border-red-500">
                        <div class="flex justify-between items-center mb-1">
                            <span class="font-bold text-red-400 text-lg">Diabetes</span>
                            <span class="font-mono text-xl font-bold">6.5% or Higher</span>
                        </div>
                        <p class="text-sm text-gray-400">Requires medical management.</p>
                    </div>
                </div>

                <!-- Estimated Average Glucose Table -->
                <div class="border-t border-gray-700 pt-6">
                    <h3 class="text-lg font-semibold text-gray-300 mb-3 flex items-center gap-2">
                        <i data-lucide="activity" class="w-4 h-4 text-purple-400"></i>
                        Estimated Avg Glucose (eAG)
                    </h3>
                    <div class="overflow-hidden rounded-lg border border-gray-700">
                        <table class="min-w-full text-center text-sm">
                            <thead class="bg-gray-900 text-gray-400 font-semibold uppercase tracking-wider">
                                <tr>
                                    <th class="px-4 py-3 border-r border-gray-700">A1C %</th>
                                    <th class="px-4 py-3">Avg Glucose (mg/dL)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-700 bg-gray-800 text-gray-300">
                                <tr class="hover:bg-gray-700/50"><td class="px-4 py-2 border-r border-gray-700 font-bold text-white">6%</td><td class="font-mono text-green-300">126</td></tr>
                                <tr class="hover:bg-gray-700/50"><td class="px-4 py-2 border-r border-gray-700 font-bold text-white">7%</td><td class="font-mono text-yellow-300">154</td></tr>
                                <tr class="hover:bg-gray-700/50"><td class="px-4 py-2 border-r border-gray-700 font-bold text-white">8%</td><td class="font-mono text-orange-300">183</td></tr>
                                <tr class="hover:bg-gray-700/50"><td class="px-4 py-2 border-r border-gray-700 font-bold text-white">9%</td><td class="font-mono text-orange-400">212</td></tr>
                                <tr class="hover:bg-gray-700/50"><td class="px-4 py-2 border-r border-gray-700 font-bold text-white">10%</td><td class="font-mono text-red-300">240</td></tr>
                                <tr class="hover:bg-gray-700/50"><td class="px-4 py-2 border-r border-gray-700 font-bold text-white">11%</td><td class="font-mono text-red-400">269</td></tr>
                                <tr class="hover:bg-gray-700/50"><td class="px-4 py-2 border-r border-gray-700 font-bold text-white">12%</td><td class="font-mono text-red-500">298</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <p class="text-xs text-gray-500 mt-2 italic">* eAG is an estimate of your average blood sugar levels over the past 2-3 months based on your A1C.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW (V7.8.0): Blood Pressure Chart Modal -->
    <div id="bp-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-80 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-xl border border-red-900/50">
            <div class="flex justify-between items-center p-6 border-b border-gray-700">
                <h2 class="text-2xl font-bold text-white flex items-center gap-2">
                    <i data-lucide="heart-pulse" class="w-6 h-6 text-red-400"></i>
                    Blood Pressure
                </h2>
                <button id="bp-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div class="p-6">
                <div class="overflow-hidden rounded-lg border border-gray-700">
                    <table class="min-w-full text-left text-sm">
                        <thead class="bg-gray-900 text-gray-400 uppercase font-semibold">
                            <tr>
                                <th class="px-4 py-3">Category</th>
                                <th class="px-4 py-3">Systolic (Upper)</th>
                                <th class="px-4 py-3">Diastolic (Lower)</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-700 bg-gray-800">
                            <!-- Normal -->
                            <tr class="bg-green-900/20">
                                <td class="px-4 py-3 font-bold text-green-400">Normal</td>
                                <td class="px-4 py-3 text-green-200">&lt; 120</td>
                                <td class="px-4 py-3 text-green-200">&lt; 80</td>
                            </tr>
                            <!-- Elevated -->
                            <tr class="bg-yellow-900/10">
                                <td class="px-4 py-3 font-bold text-yellow-400">Elevated</td>
                                <td class="px-4 py-3 text-yellow-200">120 – 129</td>
                                <td class="px-4 py-3 text-yellow-200">&lt; 80</td>
                            </tr>
                            <!-- Stage 1 -->
                            <tr class="bg-orange-900/20">
                                <td class="px-4 py-3 font-bold text-orange-400">High BP (Stage 1)</td>
                                <td class="px-4 py-3 text-orange-200">130 – 139</td>
                                <td class="px-4 py-3 text-orange-200">80 – 89</td>
                            </tr>
                            <!-- Stage 2 -->
                            <tr class="bg-red-900/20">
                                <td class="px-4 py-3 font-bold text-red-400">High BP (Stage 2)</td>
                                <td class="px-4 py-3 text-red-200">140 or higher</td>
                                <td class="px-4 py-3 text-red-200">90 or higher</td>
                            </tr>
                            <!-- Crisis -->
                            <tr class="bg-red-900/40 animate-pulse">
                                <td class="px-4 py-3 font-extrabold text-red-500">Hypertensive Crisis</td>
                                <td class="px-4 py-3 font-bold text-red-300">&gt; 180</td>
                                <td class="px-4 py-3 font-bold text-red-300">&gt; 120</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW (V7.8.0): Testosterone Chart Modal -->
    <div id="testo-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-80 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-lg border border-yellow-900/50">
            <div class="flex justify-between items-center p-6 border-b border-gray-700">
                <h2 class="text-2xl font-bold text-white flex items-center gap-2">
                    <i data-lucide="activity" class="w-6 h-6 text-yellow-400"></i>
                    Testosterone (Total)
                </h2>
                <button id="testo-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div class="p-6">
                <div class="overflow-hidden rounded-lg border border-gray-700">
                    <table class="min-w-full text-left text-sm">
                        <thead class="bg-gray-900 text-gray-400 uppercase font-semibold">
                            <tr>
                                <th class="px-4 py-3">Age Group</th>
                                <th class="px-4 py-3 text-right">Avg Range (ng/dL)</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-700 bg-gray-800">
                            <tr class="hover:bg-gray-700/50">
                                <td class="px-4 py-3 font-medium text-gray-300">Children</td>
                                <td class="px-4 py-3 text-right text-blue-300">&lt; 7 - 130</td>
                            </tr>
                            <tr class="hover:bg-gray-700/50">
                                <td class="px-4 py-3 font-medium text-gray-300">Early Teens</td>
                                <td class="px-4 py-3 text-right text-blue-300">7 - 1200</td>
                            </tr>
                            <tr class="hover:bg-gray-700/50">
                                <td class="px-4 py-3 font-medium text-white">Adults (19+)</td>
                                <td class="px-4 py-3 text-right font-bold text-green-400">240 - 950</td>
                            </tr>
                            <tr class="hover:bg-gray-700/50">
                                <td class="px-4 py-3 font-medium text-gray-300">30s</td>
                                <td class="px-4 py-3 text-right text-yellow-200">~ 219 - 1009</td>
                            </tr>
                            <tr class="hover:bg-gray-700/50">
                                <td class="px-4 py-3 font-medium text-gray-300">40s</td>
                                <td class="px-4 py-3 text-right text-yellow-200">~ 201 - 993</td>
                            </tr>
                            <tr class="hover:bg-gray-700/50">
                                <td class="px-4 py-3 font-medium text-gray-300">50s</td>
                                <td class="px-4 py-3 text-right text-yellow-200">~ 181 - 850</td>
                            </tr>
                            <tr class="hover:bg-gray-700/50">
                                <td class="px-4 py-3 font-medium text-gray-300">60s+</td>
                                <td class="px-4 py-3 text-right text-yellow-200">~ 150 - 720</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="text-xs text-gray-500 mt-3 italic">* Levels fluctuate daily. "Normal" varies by lab.</p>
            </div>
        </div>
    </div>


    <div class="flex flex-col lg:flex-row min-h-screen">
        
        <!-- Main Script Content -->
        <main class="flex-1 p-6 md:p-10 lg:p-12 overflow-y-auto pb-24">
            <div class="max-w-3xl mx-auto prose prose-lg prose-dark">
                
                <!-- Title container -->
                <div class="flex justify-between items-start mb-6">
                    <div id="title-search-container" class="relative flex-1">
                        
                        <!-- Product Line Switcher -->
                        <div id="product-line-switcher" class="text-sm font-semibold text-blue-400 mb-1 cursor-pointer hover:text-blue-300 transition-colors uppercase tracking-wider flex items-center gap-2">
                            <span id="current-product-line-display">...</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
                        </div>
                        <!-- Hidden Dropdown for Product Lines -->
                        <div id="product-line-dropdown" class="hidden absolute top-8 left-0 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-20 w-56 overflow-hidden">
                            <!-- Injected via JS -->
                        </div>

                        <div id="title-click-wrapper" class="cursor-pointer group flex items-baseline">
                            <h1 id="script-title-display" class="text-3xl font-bold text-white mb-0 group-hover:text-gray-300 transition-colors">[Script Title]</h1>
                            
                            <span id="title-search-note" class="ml-3 text-sm text-gray-400 font-normal inline-flex items-center group-hover:text-gray-300 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                </svg>
                                Click to change
                            </span>
                        </div>

                        <input type="text" id="script-search-input" class="hidden w-full max-w-sm bg-gray-700 border-gray-600 text-white rounded-lg p-3 text-2xl font-bold focus:ring-2 focus:ring-blue-500" placeholder="Search supplements..." style="line-height: 1.1;">
                        <div id="script-search-results" class="hidden absolute top-full left-0 w-full max-w-sm bg-gray-700 border border-gray-600 rounded-lg shadow-lg mt-2 z-10 overflow-hidden">
                            <!-- Search results will be populated by script.js -->
                        </div>
                    </div>
                    <!-- Reset Button -->
                    <button id="reset-app-btn" class="text-blue-400 hover:text-blue-300 border border-blue-400 hover:border-blue-300 rounded-lg px-4 py-2 text-sm font-semibold transition-colors ml-4 flex-shrink-0">
                        Next Call
                    </button>
                </div>

                <section class="mb-8">
                    <h2>Part 1: Greeting</h2>
                    <p>Hello, I'm calling for <span class="client-name-placeholder text-yellow-400">[Client Name]</span>?</p>
                    <p>Hi <span class="client-name-placeholder text-yellow-400">[Client Name]</span>. My name is <span id="agent-name-placeholder" class="agent-name-placeholder editable-span text-yellow-400 font-bold">[Agent Name]</span>. I'm a specialist at <span class="base-product-name-script">...</span>, the supplement you ordered online. How are you doing today?</p>
                    <p>The reason I'm calling is you have been assigned as my client, and I reach out to all of my clients onboarding. I'm going to ask you some questions so I can best offer my guidance to help you with this. Okay?</p>
                </section>

                    <h2 class="mt-0">Part 2: Discovery</h2>
                    <div class="space-y-6">
                        <!-- Client Name Input -->
                        <div>
                            <label for="client-name" class="block text-lg font-semibold text-gray-300 mb-2">Client Name:</label>
                            <div class="relative">
                                <input type="text" id="client-name" placeholder="Enter client's name to start timer..." class="w-full bg-gray-700 border-gray-600 text-white rounded-lg p-3 pr-12 focus:ring-2 focus:ring-blue-500">
                                <button id="start-timer-manual-btn" class="absolute right-2 top-1/2 -translate-y-1/2 w-9 h-9 bg-blue-600 hover:bg-blue-700 rounded-full flex items-center justify-center text-white transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-0.5" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" />
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- Config Dropdowns -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- This hidden select is still used as the source of truth -->
                            <select id="regimen-length" class="hidden">
                                <option value="18" selected>18 Months (Full)</option>
                                <option value="12">12 Months (Walk-down 1)</option>
                                <option value="6">6 Months (Walk-down 2)</option>
                                <option value="3">3 Months (Walk-down 3)</option>
                            </select>
                            
                            <div>
                                <label for="gender" class="block text-sm font-semibold text-gray-300 mb-2">Client Gender:</label>
                                <select id="gender" class="w-full bg-gray-700 border-gray-600 text-white rounded-lg p-3 focus:ring-2 focus:ring-blue-500">
                                    <option value="any">Unspecified</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                </select>
                            </div>
                        </div>

                        <!-- Questions -->
                        <div class="flex items-center gap-2 mt-4">
                            <button id="quick-edit-questions-btn" class="text-gray-500 hover:text-white transition-colors p-1 rounded" title="Edit Questions">
                                <i data-lucide="settings" class="w-5 h-5"></i>
                            </button>
                            <p class="font-semibold text-lg">Questions:</p>
                        </div>
                        
                        <div id="discovery-questions-list" class="space-y-4 pl-2">
                            <!-- Questions will be dynamically inserted here by script-ui.js -->
                        </div>

                        <!-- Interactive Symptom Checkboxes -->
                        <p class="font-semibold text-lg mt-6">Symptoms Checklist:</p>
                        <div id="symptom-checklist-container" class="space-y-4">
                            <!-- Dynamically generated symptoms go here -->
                        </div>
                    </div>

                <!-- Part 3: The Tell (Telling not Selling) -->
                <section class="mb-8">
                    <h2>Part 3: The Tell (Telling not Selling)</h2>
                    <p>Okay well <span class="client-name-placeholder text-yellow-400">[Client Name]</span>, I have a really good understanding of your situation now. And based on everything that you'vetold me, I can definitely help you get the results we're looking to see. That being said, I'm going to put you on a very specific regiment that is going to help take care of this. Okay?</p>
                    
                    <p>Great. So for your regiment here, you're going to take your <span id="base-product-name-tell" class="base-product-name-script">...</span> daily, first thing in the morning. Okay?</p>
                    
                    <div id="dynamic-pitch-content" class="mt-6 p-6 bg-gray-800 rounded-2xl shadow-inner">
                        <p class="italic text-yellow-400">Your personalized add-on pitch will appear here as you select symptoms...</p>
                    </div>

                    <div id="dynamic-benefits-list" class="mt-6 p-6 bg-gray-800 rounded-2xl shadow-inner">
                         <p class="italic text-yellow-400">Your summary of benefits will appear here...</p>
                    </div>

                    <p>And this regiment here is only going to be for <strong class="text-yellow-400"><span id="pitch-length-1">18</span> months</strong>, and then you're done completely. Okay? So this is not something you're going to do forever. That's because the first <strong class="text-yellow-400"><span id="pitch-length-half">9</span> months</strong> are meant to help you get all of the results I'vementioned. And the reason you take this for another <strong class="text-yellow-400"><span id="pitch-length-half-2">9</span> months</strong> after that is to help your body bio-acclimate and maintain these results on its own. Simply put, once you're done, you're done for good. Does that make sense?</p>
                    
                    <p>Okay perfect. This is all going to be very straight forward. You're going to have the instructions and information on the bottles. But I do like to remind all of my clients that I am your specialist, so if you have any questions, don't hesitate to call me. Okay, <span class="client-name-placeholder text-yellow-400">[Client Name]</span>?</p>
                </section>
                
                <!-- Part 4: The Close -->
                <section class="mb-8">
                    <h2>Part 4: The Close</h2>
                    <p>Alright. And it is going to be this phone number here that I'm calling you from, this <span id="agent-phone-placeholder" class="editable-span text-yellow-400 font-bold">[###]</span> number. And, again, my name is <span class="agent-name-placeholder text-yellow-400 font-bold">[Agent Name]</span>. Feel free to save that in your phone. I'm going to be your main point of contact, so I'll be here to help you monday through friday, 9 to 5 central time. Okay?</p>
                    
                    <p>I do also like to mention, <span class="client-name-placeholder text-yellow-400">[Client Name]</span>, if for some reason you are not seeing any initial results or any improvement within the first <strong class="text-yellow-400"><span id="guarantee-days-1">60</span> days</strong>, just go ahead and give me a call, and we will make sure to get this whole thing refunded to you. Okay? Because we wanna make sure that this is working for you. Okay?</p>
                    
                    <p>Now I'm going to re-verify a couple of pieces of information with you before I get you going on the rest of your regimen. Your shipping address is [ADDRESS] correct? [IF NO, CORRECT IT]. And your email is [EMAIL], is that right? [IF NO, CORRECT IT]</p>
                    
                    <p>Perfect. Alright. Now online, these typically $69 a bottle, but with your specialist discounts, I'm going to bring that all the way down to just <strong class="text-yellow-400">$<span id="pitch-price">45</span> per bottle</strong>. Now we don't save any client card information, so we'll need to get a new card reverified. We accept Visa, Mastercard, or Discover.</p>
                </section>


                <!-- Part 5: Authorization & Closing -->
                <section class="mb-8">
                    <h2>Part 5: Authorization & Closing</h2>
                    
                    <h3>CARD</h3>
                    <p>Okay, let's start with the expiration? ... The cvv on the back? Now let me move us to a
                    non-recorded line so I can get that card number. ... Hello, can you hear me? ... Perfect, what is
                    that card number? ... Let me read it back to you. ... I'm moving us back to that recorded line. ...
                    We’re back on that recorded line. Is the billing address the same as the shipping? [IF NOT, ASK
                    FOR BILLING] And Was there a middle initial or just first and last for the name on the card?</p>

                    <h3 class="mt-6">AUTHO SCRIPT</h3>
                    <p>So now I’m going to read you this authorization statement here. It's going to sound a little
                    repetitive, so bear with me. And I do need to get your okay three times. And like I said, we don't
                    save any client card information. So we don't do any monthly subscriptions. So I'm going to get
                    you out everything that you need from start to finish for the full <strong class="text-yellow-400"><span id="autho-length-1">18</span> months</strong> today. So it'll
                    be a onetime purchase. Okay?</p>
                    

                    <div id="online-order-editor" class="online-order-editor my-6">
                        <label class="block text-lg font-semibold text-gray-300 mb-3">Online Order Items</label>
                        <div id="online-order-list" class="space-y-2 mb-3">
                            <!-- Items populated by script-ui.js -->
                        </div>
                        <div class="relative">
                            <input type="text" id="online-order-search" class="w-full bg-gray-700 border-gray-600 text-white rounded-lg p-3" placeholder="Type to add supplement...">
                            <div id="online-order-search-results" class="hidden absolute top-full left-0 w-full bg-gray-700 border border-gray-600 rounded-lg shadow-lg mt-1 z-10 overflow-hidden">
                                <!-- Search results will be populated by script-ui.js -->
                            </div>
                        </div>
                    </div>

                    <p id="autho-script-online-part" class="my-4">Now online you've already ordered...</p>
                    
                    <div id="autho-script-dynamic-wording" class="my-4">
                        <p>So all I have left to do now is send you ...</p>
                    </div>

                    <!-- MODIFIED: New script wording -->
                    <p>Typically this regimen would cost you <strong class="text-yellow-400">$<span id="autho-online-cost">...</span></strong> online, now as your specialist, I'm able to apply my specialist discount, waive shipping and handling, and bring that all the way down to a one-time additional payment of just <strong class="text-yellow-400">$<span id="autho-cost">...</span></strong> US Dollars, and we will put that discounted amount on the <strong class="text-yellow-400">[CARD TYPE]</strong> ending in <strong class="text-yellow-400">[XXXX]</strong>. Okay?</p>
                    
                    <p>For your safety, I always say it twice. You do authorize the one-time additional payment of the
                    <strong class="text-yellow-400">$<span id="autho-cost-2">...</span></strong> US Dollars on the <strong class="text-yellow-400">[CARD TYPE]</strong> ending in <strong class="text-yellow-400">[XXXX]</strong>, is that correct?</p>
                    
                    <div class="my-6 p-4 bg-gray-800 rounded-lg">
                        <label for="autho-regimen-length" class="block text-lg font-semibold text-yellow-400 mb-2">Regimen Length (Walkdown):</label>
                        <p class="text-sm text-gray-400 mb-2 italic">If client has price objection, use this to walk down the price. It will sync and recalculate the script.</p>
                        <select id="autho-regimen-length" class="w-full bg-gray-700 border-gray-600 text-white rounded-lg p-3 focus:ring-2 focus:ring-blue-500">
                            <option value="18">18 Months (Full)</option>
                            <option value="12">12 Months (Walk-down 1)</option>
                            <option value="6">6 Months (Walk-down 2)</option>
                            <option value="3">3 Months (Walk-down 3)</option>
                        </select>
                    </div>

                    <h3 class="mt-6">ORDER BREAKDOWN</h3>
                    <p><span id="order-breakdown-online-part">Online, you ordered...</span></p>
                    
                    <div id="order-breakdown-dynamic-wording" class="my-4">
                        <p>Now with your new order,
                        you'll be getting <strong class="text-yellow-400"><span id="order-main-supp-needed">...</span></strong> additional <strong class="text-yellow-400 order-main-supp-2 base-product-name-script">...</span></strong> and the full <strong class="text-yellow-400"><span id="order-length">18</span>-month</strong> supply of <strong class="text-yellow-400"><span id="order-addons-list">...</span></strong> for the additional <strong class="text-yellow-400">$<span id="order-cost">...</span></strong>.</p>
                    </div>

                    <p id="order-breakdown-completion-wording">That will complete your
                    regiment and you'll see this coming out in two different packages. Give the order 5 to 7
                    business days to reach you, okay? And for your clarity, the bank statement will be from
                    "Supplement Phone Order."</p>

                    <p>Okay, the company policy enforces me to say this disclaimer, are you ready, I just need you to
                    agree, okay?</p>
                    
                    <p class="my-4 p-4 bg-gray-700 rounded-lg italic border-l-4 border-yellow-500">
                    Now to clarify, I’m obviously not a medical professional, and these supplements aren’t intended
                    to diagnose, treat, cure, or prevent any disease. The FDA has not evaluated these statements.
                    Results vary. Some customers see great benefits, others see no change. If you’re taking
                    prescription medications, check with a healthcare provider. That said, you have nothing to
                    worry about with our <strong class="text-yellow-300"><span id="guarantee-days-2">60</span>-day</strong> refund policy. If you’re unsatisfied, just give me a call back and I’ll
                    help set up the return. Does that make sense?
                    </p>
                    
                    <p>Perfect. Give me a quick moment to check in with the processing team... [IF NO -> DECLINE RES
                    | IF YES -> CONTINUE] Alright, the charge did go through.</p>

                    <h3 class="mt-6">CLOSING</h3>
                    <p>Now, each supplement will have the instructions on the label. You will also get an email of the
                    receipt and tracking information. When you get that first package, wait for the second package
                    to get there so you can start all the supplements at the same time. I’m very excited for you to
                    start seeing those results. Did you have any last minute questions I could answer for you? [IF
                    YES, ANSWER | IF NO -> CONTINUE]</p>
                    <p>Alright, I’ll get your package prepared to be sent out. Other than that, I hope you have a great
                    rest of your day. Bye.</p>
                    
                    <hr class="my-6 border-gray-600">
                    
                    <h3 class="mt-6 text-red-400">DECLINE RES</h3>
                    <p>Processing just sent me an email here. They’re letting me know that your bank wants to get
                    your okay on this before we send it out. So go ahead and check your email or your text. You
                    should get a notification. They’re going to ask for your okay and if you recognize the charge
                    amount.</p>
                    
                    <h4 class="mt-4 font-semibold text-yellow-400">IF NOT</h4>
                    <p>Alright, since your bank hasn’t sent you a notification, I’ll have you call them. Let them
                    know you authorize the <strong class="text-yellow-400">$<span id="decline-cost">...</span></strong> from “Supplement Phone Order.” I’ll call you back in 10 or so
                    minutes to finish the authorization. You Should have a number on the back of your card to call.</p>
                    
                    <h4 class="mt-4 font-semibold text-yellow-400">Pick up Card</h4>
                    <p>Means simple decline, will get text/email to verify if they authorized the
                    purchase, or will need to call bank</p>
                </section>

            </div>
        </main>

        <!-- Sidebar -->
        <aside class="w-full lg:w-1/3 xl:w-1/4 bg-gray-800 p-6 shadow-2xl overflow-y-auto lg:sticky lg:top-0 lg:h-screen pb-24">
            
            <!-- NEW: Reference Buttons -->
            <div class="mb-6">
                <h2 class="text-2xl font-semibold text-white border-b border-gray-700 pb-3 mb-4">References</h2>
                <div id="reference-buttons-container" class="flex flex-wrap gap-2">
                    <!-- Reference buttons will be injected here -->
                    <p id="no-references-placeholder" class="text-sm text-gray-400 italic">No references set for this supplement. (Edit in Settings > Section 3)</p>
                </div>
            </div>

            <!-- Notes Section -->
            <div class="mb-6">
                <h2 class="text-2xl font-semibold text-white border-b border-gray-700 pb-3 mb-4">Call Notes</h2>
                <div class="space-y-3">
                    <p id="generated-notes" class="text-sm text-gray-300 italic p-3 bg-gray-900 rounded-lg">Pitched: </p>
                    <textarea id="custom-notes" class="w-full bg-gray-700 border-gray-600 text-white rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500" rows="4" placeholder="Add custom notes here..."></textarea>
                    <button id="copy-notes-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors flex items-center justify-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                        </svg>
                        <span>Copy Notes</span>
                    </button>
                </div>
            </div>

            <h2 class="text-2xl font-semibold text-white border-b border-gray-700 pb-3 mb-6">Regimen Preview</h2>
            
            <div id="regimen-list" class="space-y-4">
                <!-- Base Product (Always On) -->
                <div class="bg-gray-700 p-4 rounded-lg shadow border-l-4 border-blue-500">
                    <h3 id="base-product-name-sidebar" class="text-lg font-semibold text-blue-300">...</h3>
                    <p id="base-product-pitch-sidebar" class="text-sm text-gray-300 italic mt-1">...</p>
                </div>
                
                <div id="dynamic-recommendations" class="space-y-4">
                    <!-- Placeholder -->
                    <p id="sidebar-placeholder" class="text-gray-400 italic text-center p-4">Select symptoms from Part 2 to build the regimen.</p>
                </div>
            </div>
        </aside>
    </div>

    <!-- Floating Timer Bar -->
    <div id="floating-timer-bar" class="fixed bottom-4 left-1/2 -translate-x-1/2 flex items-center justify-center gap-2 z-40 p-2 bg-gray-900 bg-opacity-70 backdrop-blur-sm rounded-full shadow-lg">
        <!-- Segments will be dynamically inserted here -->
    </div>

   <!-- SCRIPT_INJECTION_POINT --> 
</body>
</html>
